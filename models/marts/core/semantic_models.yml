version: 3


models:
  - name: dim_customers
    semantic_model:
      enabled: true
      name: dim_customers
    description: |
      Customer dim table at the individual customer level.  This table contains one row
      per customer and includes the customer key
    columns:
      - name: customer_key
        entity:
          type: primary
          name: customer
      - name: market_segment
        dimension:
          type: categorical
          name: customer_market_segment
      - name: nation
        dimension:
          type: categorical
          name: customer_nation
      - name: region
        dimension:
          type: categorical
          name: customer_region
    derived_semantics:
      entities: []
      dimensions:
        - name: customer_balance_segment
          type: categorical
          expr: |-
            case
              when account_balance < 0 then 'Bad Debt'
              when account_balance < 2500 then 'Low'
              when account_balance < 7500 then 'Medium'
              else 'High'
            end
